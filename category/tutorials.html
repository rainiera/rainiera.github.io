<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />

    <title>rainier</title>

    <meta charset="utf-8" />
    <link rel="stylesheet" href="/theme/css/poole.css"/>
    <link rel="stylesheet" href="/theme/css/syntax.css"/>
    <link rel="stylesheet" href="/theme/css/lanyon.css"/>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">
    <link rel="stylesheet" href="/theme/css/styles.css"/>
  </head>

  <body class="layout-reverse">
<!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">
<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <div class="profile">
      <img src="/theme/img/profile.png"/>
    </div>
  </div>

  <nav class="sidebar-nav">

    <a class="sidebar-nav-item" href="/blog">blog</a>
    <a class="sidebar-nav-item" href="/projects">projects</a>
    <a class="sidebar-nav-item" href="/">Rainier&nbsp;Ababao</a>


  </nav>

  <div class="sidebar-item">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
    <ul class="social">
      <li><a class="sc-github" href="https://github.com/rainiera" target="_blank"><i class="fa fa-github"></i></a></li>
      <li><a class="sc-angellist" href="https://angel.co/rainiera" target="_blank"><i class="fa fa-angellist"></i></a></li>
      <li><a class="sc-linkedin" href="https://linkedin.com/in/rainiera" target="_blank"><i class="fa fa-linkedin"></i></a></li>
      <li><a class="sc-twitter" href="https://twitter.com/rainieratx" target="_blank"><i class="fa fa-twitter"></i></a></li>
    </ul>
  </div>

  <div class="sidebar-item">
    <p>
    &copy; 2016. All rights reserved.
    </p>
    <p class="tiny-note">
      <a class="muted" href="https://github.com/rainiera/pelicanyan">pelicanyan v0.1</a>
    </p>
  </div>
</div>    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">rainier</a>
            <small>codes, reads, and blogs</small>
          </h3>
        </div>
      </div>

      <div class="container content">
<div class="content-title">
<h2>Tutorials category</h2>
</div>
<div class="posts">
  <div class="post">
    <h1 class="post-title">
      <a href="/crazy-python-one-liners.html" rel="bookmark" title="Permalink to Crazy Python one-liners">Crazy Python&nbsp;one-liners</a>
    </h1>
    <span class="post-date">July 28, 2016</span>

    <h2>Motivation</h2>
<p>In this post, we will explore a string manipulation task with the constraint that the solution is to be in as few lines as possible. Why? Just for fun. I would <em>never</em> commit an unclear, maybe inefficient one-liner into production code just to show off, and you shouldn&#8217;t either. However, I think this and similar constraint puzzles (in the category of what is called &#8220;code golf&#8221;) are really fun mental exercises in abstraction, problem decomposition, and mastering a language&#8217;s esoteric&nbsp;features.</p>
<p>The Slack for one of the student organizations I&#8217;m in has a channel called #<em>politics</em>. The channel&#8217;s pinned post is an ever-growing <span class="caps">URL</span> to a visualization of each channel member&#8217;s political views on the two axes of the political spectrum created by this website: &#8220;Libertarian-Authoritarian&#8221; and&nbsp;&#8220;Left-Right&#8221;.</p>
<p>The following is a sample <span class="caps">URL</span> that&#8217;s pinned in our channel (names replaced with the Greek&nbsp;alphabet):</p>
<div class="highlight"><pre><span></span>https://www.politicalcompass.org/crowdchart?alpha=-3.38%2C-5.38&amp;beta=-2.75%2C-4.62&amp;gamma=-4.63%2C-4.15&amp;delta=-4.75%2C-4.97&amp;epsilon=-9.0%2C-8.31&amp;zeta=-7.38%2C-4.36&amp;eta=-3.5%2C-3.6&amp;theta=-4.38%2C-2.92&amp;iota=-7.13%2C-6.0&amp;kappa=1.63%2C-2.36&amp;lambda=-5.75%2C-6.51&amp;mu=-3.25%2C-3.64&amp;nu=1.75%2C-2.15&amp;xi=-3.75%2C-5.08&amp;name=omicron&amp;ec=-4.88&amp;soc=-2.05
</pre></div>


<p>And a sample&nbsp;image:</p>
<p><img alt="image" src="https://www.politicalcompass.org/charts/crowdchart?alpha=-3.38%2C-5.38&amp;beta=-2.75%2C-4.62&amp;gamma=-4.63%2C-4.15&amp;delta=-4.75%2C-4.97&amp;epsilon=-9.0%2C-8.31&amp;zeta=-7.38%2C-4.36&amp;eta=-3.5%2C-3.6&amp;theta=-4.38%2C-2.92&amp;iota=-7.13%2C-6.0&amp;kappa=1.63%2C-2.36&amp;lambda=-5.75%2C-6.51&amp;mu=-3.25%2C-3.64&amp;nu=1.75%2C-2.15&amp;xi=-3.75%2C-5.08&amp;name=omicron&amp;ec=-4.88&amp;soc=-2.05" /></p>
<p>(Not surprising, considering that I go to the University of Texas). It would be nice to get a <span class="caps">JSON</span> encoding of this information so we might be able to integrate it into dataviz tools for&nbsp;practice.</p>
<h2>Problem</h2>
<p>Given an <span class="caps">URL</span>, such&nbsp;as:</p>
<div class="highlight"><pre><span></span>https://www.politicalcompass.org/charts/crowdchart?alpha=-3.38%2C-5.38&amp;beta=-2.75%2C-4.62&amp;gamma=-4.63%2C-4.15&amp;name=omicron&amp;ec=-4.88&amp;soc=-2.05
</pre></div>


<p>write a function to deserialize it into a <span class="caps">JSON</span>-like encoding, such&nbsp;as:</p>
<div class="highlight"><pre><span></span>[
    {
        &quot;alpha&quot;: {
            &quot;economic&quot;: &quot;-3.38&quot;,
            &quot;social&quot;: &quot;-5.38&quot;
        }
    },
    {
        &quot;beta&quot;: {
            &quot;economic&quot;: &quot;-2.75&quot;,
            &quot;social&quot;: &quot;-4.62&quot;
        }
    },
    {
        &quot;gamma&quot;: {
            &quot;economic&quot;: &quot;-4.63&quot;,
            &quot;social&quot;: &quot;-4.15&quot;
        }
    },
    {
        &quot;omicron&quot;: {
            &quot;economic&quot;: &quot;-4.88&quot;,
            &quot;social&quot;: &quot;-2.05&quot;
        }
    }
]
</pre></div>


<p>using as few lines as&nbsp;possible.</p>
<h2>Decomposition</h2>
<p>We are mainly interested in the names of people and their econo-/socio- political preference scores, which are delimited by various characters. In a string <code>s = 'https://www.politicalcompass.org/charts/crowdchart?alpha=-3.38%2C-5.38&amp;beta=-2.75%2C-4.62&amp;gamma=-4.63%2C-4.15&amp;name=omicron&amp;ec=-4.88&amp;soc=-2.05'</code>, we can split it by <code>?</code> to return a list&nbsp;object:</p>
<div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;https://www.politicalcompass.org/charts/crowdchart?alpha=-3.38%2C-5.38&amp;beta=-2.75%2C-4.62&amp;gamma=-4.63%2C-4.15&amp;name=omicron&amp;ec=-4.88&amp;soc=-2.05&#39;</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
<span class="p">[</span><span class="s1">&#39;https://www.politicalcompass.org/charts/crowdchart&#39;</span><span class="p">,</span>
 <span class="s1">&#39;alpha=-3.38%2C-5.38&amp;beta=-2.75%2C-4.62&amp;gamma=-4.63%2C-4.15&amp;name=omicron&amp;ec=-4.88&amp;soc=-2.05&#39;</span><span class="p">]</span>
</pre></div>


<p>Now we can get the string we&#8217;re interested in using the expression <code>s.split('?')[1]</code>. In length-constrained coding, we want to minimize the number of new variable assignments, and this language&#8217;s <span class="caps">AST</span> lets us do this. Since <code>s.split('?')[1]</code> returns our string of interest, we can call <code>.split('&amp;')</code> on that expression to obtain a list of&nbsp;strings:</p>
<div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
<span class="p">[</span><span class="s1">&#39;alpha=-3.38%2C-5.38&#39;</span><span class="p">,</span>
 <span class="s1">&#39;beta=-2.75%2C-4.62&#39;</span><span class="p">,</span>
 <span class="s1">&#39;gamma=-4.63%2C-4.15&#39;</span><span class="p">,</span>
 <span class="s1">&#39;name=omicron&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ec=-4.88&#39;</span><span class="p">,</span>
 <span class="s1">&#39;soc=-2.05&#39;</span><span class="p">]</span>
</pre></div>


<p>We are getting closer to the form we would like, but there is some cleaning up to do with special cases at the end. As soon as a person (let&#8217;s say their name is <code>omicron</code>) adds their own name and scores to the list, the new <span class="caps">HTTP</span> <span class="caps">GET</span> parameters remain encoded in the <span class="caps">URL</span> (after the third-to-the-last <code>&amp;</code>). (The endpoint handler can handle URLs without the last three <span class="caps">GET</span> parameters, but we don&#8217;t want the client to have to conform their parameters to the previous parameters by hand). Let&#8217;s make an expression to select the last 3 elements in the list to transform it into one element that conforms to the rest of the&nbsp;list:</p>
<div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="p">[</span><span class="s1">&#39;name=omicron&#39;</span><span class="p">,</span> <span class="s1">&#39;ec=-4.88&#39;</span><span class="p">,</span> <span class="s1">&#39;soc=-2.05&#39;</span><span class="p">]</span>
</pre></div>


<p>But we&#8217;re still only interested in the string parts after the <code>=</code>, and want to make a sequence of those to combine later. If we only focus on one string <code>name=omicron</code>, we can see that we want to call <code>split('=')</code> and grab only second element of its return, i.e., <code>'name=omicron'.split('=')[1]</code>. But what if we wanted to apply this function to a list of&nbsp;strings?</p>
<p><strong>Enter the lambda syntax.</strong> With <code>lambda</code>, we can convert a function into a&nbsp;one-liner.</p>
<div class="highlight"><pre><span></span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>


<p>We can even assign it to a variable and call it like&nbsp;this:</p>
<div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">my_lambda</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">my_lambda</span><span class="p">(</span><span class="s1">&#39;foo=bar&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="s1">&#39;bar&#39;</span>
</pre></div>


<p>Also note that it looks like a mathematical function, such as f(x). But like I said earlier, we&#8217;ll keep assigning expressions to variables to the minimum. It&#8217;s important to understand that the lambda definition always contains an expression (after the <code>:</code>) that is returned upon&nbsp;evaluation.</p>
<p>So back to the last question - how do we apply this function to a list of strings that have <code>=</code> in&nbsp;them?</p>
<p><strong>Enter the map syntax.</strong> <code>map(func, seq)</code> applies function <code>func</code> to every element in sequence <code>seq</code>, and it always returns a sequence (such as a <code>list</code> or <code>tuple</code>) such that each element is the return of the function applied to that element. It&#8217;s probably easier to show&nbsp;you:</p>
<div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="nb">map</span><span class="p">(</span><span class="n">my_lambda</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;foo=bar&#39;</span><span class="p">,</span> <span class="s1">&#39;baz=qux&#39;</span><span class="p">,</span> <span class="s1">&#39;ham=spam&#39;</span><span class="p">,</span> <span class="s1">&#39;eggs=bacon&#39;</span><span class="p">])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="p">[</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;qux&#39;</span><span class="p">,</span> <span class="s1">&#39;spam&#39;</span><span class="p">,</span> <span class="s1">&#39;bacon&#39;</span><span class="p">]</span>
</pre></div>


<p>Let&#8217;s use <code>map</code> and <code>lambda</code> to compose a list of the strings we were interested in, building on the list expression we composed earlier in <code>[4]</code>:</p>
<div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="p">:])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="p">[</span><span class="s1">&#39;omicron&#39;</span><span class="p">,</span> <span class="s1">&#39;-4.88&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.05&#39;</span><span class="p">]</span>
</pre></div>


<p>Now use this list as arguments and the string <code>'{}={}%2C{}'</code> as the caller to the function <code>str.format(*args)</code> to get a string that conforms to the other strings (e.g., <code>alpha=-3.38%2C-5.38</code>) in the original&nbsp;list:</p>
<div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="s1">&#39;{}={}%2C{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]))</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="s1">&#39;omicron=-4.88%2C-2.05&#39;</span>
</pre></div>


<p>(<code>*</code> is the &#8220;splat&#8221; operator, which converts a Python list into positional arguments in a function&nbsp;call.)</p>
<p>Before we append this string to the original list, let&#8217;s get all but the last 3 elements from the original list in <code>[3]</code>:</p>
<div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="p">[</span><span class="s1">&#39;alpha=-3.38%2C-5.38&#39;</span><span class="p">,</span> <span class="s1">&#39;beta=-2.75%2C-4.62&#39;</span><span class="p">,</span> <span class="s1">&#39;gamma=-4.63%2C-4.15&#39;</span><span class="p">]</span>
</pre></div>


<p>We can wrap the expression from <code>[9]</code> that returns the new string in brackets to convert it into a single-item list, and append it to the original list using the <code>+</code> operator:</p>
<div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;{}={}%2C{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]))]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span>
<span class="p">[</span><span class="s1">&#39;alpha=-3.38%2C-5.38&#39;</span><span class="p">,</span>
 <span class="s1">&#39;beta=-2.75%2C-4.62&#39;</span><span class="p">,</span>
 <span class="s1">&#39;gamma=-4.63%2C-4.15&#39;</span><span class="p">,</span>
 <span class="s1">&#39;omicron=-4.88%2C-2.05&#39;</span><span class="p">]</span>
</pre></div>


<p>We need to break up each string by <code>=</code> and <code>%2C</code> now. Hello, <code>map</code> and <code>lambda</code> again:</p>
<div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;%2C&#39;</span><span class="p">),</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;{}={}%2C{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]))])</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span>
<span class="p">[[</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;-3.38&#39;</span><span class="p">,</span> <span class="s1">&#39;-5.38&#39;</span><span class="p">],</span>
 <span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.75&#39;</span><span class="p">,</span> <span class="s1">&#39;-4.62&#39;</span><span class="p">],</span>
 <span class="p">[</span><span class="s1">&#39;gamma&#39;</span><span class="p">,</span> <span class="s1">&#39;-4.63&#39;</span><span class="p">,</span> <span class="s1">&#39;-4.15&#39;</span><span class="p">],</span>
 <span class="p">[</span><span class="s1">&#39;omicron&#39;</span><span class="p">,</span> <span class="s1">&#39;-4.88&#39;</span><span class="p">,</span> <span class="s1">&#39;-2.05&#39;</span><span class="p">]]</span>
</pre></div>


<p>And the final <code>map</code>/<code>lambda</code> combo:</p>
<div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">convert_to_dictlist</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">{</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;economic&#39;</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;social&#39;</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]}},</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;%2C&#39;</span><span class="p">),</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;{}={}%2C{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]))]))</span>
</pre></div>


<p>Let&#8217;s try&nbsp;it:</p>
<div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">convert_to_dictlist</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span>
<span class="p">[{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;economic&#39;</span><span class="p">:</span> <span class="s1">&#39;-3.38&#39;</span><span class="p">,</span> <span class="s1">&#39;social&#39;</span><span class="p">:</span> <span class="s1">&#39;-5.38&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;economic&#39;</span><span class="p">:</span> <span class="s1">&#39;-2.75&#39;</span><span class="p">,</span> <span class="s1">&#39;social&#39;</span><span class="p">:</span> <span class="s1">&#39;-4.62&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;economic&#39;</span><span class="p">:</span> <span class="s1">&#39;-4.63&#39;</span><span class="p">,</span> <span class="s1">&#39;social&#39;</span><span class="p">:</span> <span class="s1">&#39;-4.15&#39;</span><span class="p">}},</span>
 <span class="p">{</span><span class="s1">&#39;omicron&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;economic&#39;</span><span class="p">:</span> <span class="s1">&#39;-4.88&#39;</span><span class="p">,</span> <span class="s1">&#39;social&#39;</span><span class="p">:</span> <span class="s1">&#39;-2.05&#39;</span><span class="p">}}]</span>
</pre></div>


<p>It worked, and we defined the function in one&nbsp;line.</p>
<p>We can use <code>print json.dumps()</code> to print it out in a nicer looking&nbsp;format.</p>
<div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">json</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="k">print</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">convert_to_dictlist</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;economic&quot;</span><span class="p">:</span> <span class="s2">&quot;-3.38&quot;</span><span class="p">,</span>
            <span class="s2">&quot;social&quot;</span><span class="p">:</span> <span class="s2">&quot;-5.38&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;beta&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;economic&quot;</span><span class="p">:</span> <span class="s2">&quot;-2.75&quot;</span><span class="p">,</span>
            <span class="s2">&quot;social&quot;</span><span class="p">:</span> <span class="s2">&quot;-4.62&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;economic&quot;</span><span class="p">:</span> <span class="s2">&quot;-4.63&quot;</span><span class="p">,</span>
            <span class="s2">&quot;social&quot;</span><span class="p">:</span> <span class="s2">&quot;-4.15&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;omicron&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;economic&quot;</span><span class="p">:</span> <span class="s2">&quot;-4.88&quot;</span><span class="p">,</span>
            <span class="s2">&quot;social&quot;</span><span class="p">:</span> <span class="s2">&quot;-2.05&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>


<p>Nice!!</p>
<h2>The&nbsp;answer</h2>
<p><strong>Disclaimer</strong></p>
<p>I didn&#8217;t get this one-liner immediately off the top of my head and on the first try. I use a fantastic <span class="caps">REPL</span>/interactive shell called <a href="https://ipython.org/">IPython</a> (where the <code>In</code>/<code>Out</code> lines come from) that makes it easy to quickly iterate (no pun intended) on composing Python code. There, I decomposed the problem, made dozens of intermediate variable assignments to heavily abstract, and then substituted the variables with the original statements and expressions they were assigned&nbsp;to.</p>
<p><strong>The&nbsp;one-liner</strong></p>
<div class="highlight"><pre><span></span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">{</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;economic&#39;</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;social&#39;</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]}},</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;%2C&#39;</span><span class="p">),</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;{}={}%2C{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]))]))</span>
</pre></div>


<p><strong>Expanded for&nbsp;&#8220;clarity&#8221;</strong></p>
<div class="highlight"><pre><span></span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span>
  <span class="nb">map</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span>
      <span class="p">{</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="p">{</span> <span class="s1">&#39;economic&#39;</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;social&#39;</span> <span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">}</span> <span class="p">}</span>
      <span class="nb">map</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span>
          <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;%2C&#39;</span><span class="p">),</span>
            <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;{}={}%2C{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span>
            <span class="nb">map</span><span class="p">(</span>
              <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span>
              <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span>
            <span class="p">)</span>
            <span class="p">)</span>
          <span class="p">]</span>
      <span class="p">)</span>
  <span class="p">}</span>
</pre></div>


<h2>Resources</h2>
<p>Some links about <code>map</code> and <code>lambda</code> (kinda Python specific) since my explanation didn&#8217;t do it&nbsp;justice:</p>
<p>A pretty approachable introduction to lambda expressions in Python that demonstrates their usefulness in production code, scoping rules, and addresses common points of confusion: <a href="https://pythonconquerstheuniverse.wordpress.com/2011/08/29/lambda_tutorial/">Yet Another Lambda&nbsp;Tutorial</a></p>
<p>Quora: <a href="https://www.quora.com/Is-it-better-to-use-list-comprehensions-or-map-with-a-lambda-function-when-manipulating-elements-in-a-list">Is it better to use list comprehensions or map with a lambda function when manipulating elements in a&nbsp;list?</a></p>
<p><em>Does your favorite programming language have syntax for map, filter, reduce, and/or lambda&nbsp;expressions?</em></p>
  </div>
  <div class="post">
    <h1 class="post-title">
      <a href="/optimizing-your-iteration-speed.html" rel="bookmark" title="Permalink to Optimizing your iteration speed">Optimizing your iteration&nbsp;speed</a>
    </h1>
    <span class="post-date">July 10, 2016</span>

    <p>One Quora answer that&#8217;s really stuck with me for the past few months is <a href="https://www.quora.com/What-are-the-things-required-to-become-a-hardcore-programmer/answer/Edmond-Lau">Edmond Lau&#8217;s answer</a> to &#8220;What are the things required to become a hardcore programmer?&#8221; The entire answer is solid, but this is the part I will focus&nbsp;on:</p>
<blockquote>
<p><strong>4. Optimize your iteration&nbsp;speed.</strong></p>
<p>Say it takes you 12 seconds to search and navigate from a function call to where it’s defined. And suppose you have to do similar navigations 60 times per day. That’s 12 minutes per day spent navigating files. If you learn enough keyboard shortcuts in your text editor to navigate to a file in 2 seconds instead of 12, then over the course of a day, you&#8217;d save 10 minutes. Every year, you’d save an entire 40-hour work&nbsp;week.</p>
<p>Find 3 more similar optimizations, and you’d save a month. Imagine what you could do with an extra month per&nbsp;year.</p>
<p>Or suppose that you’re fixing a bug that requires you to start the app and then navigate through five screens to set up the right conditions to trigger the bug. Could you spend 10 minutes to wire it up so that it goes to the buggy screen on startup? You’d be able to iterate significantly faster on that bug with a small initial&nbsp;investment.</p>
<p>Systematically ask yourself, “How can I iterate faster?” The payoffs will be&nbsp;enormous.</p>
</blockquote>
<p>One of the payoffs, not explicitly mentioned, is that decreasing your iteration time will lower your chances of emptying your mental &#8220;cache&#8221; or &#8220;stack&#8221; of things to do, i.e., getting distracted, while you&#8217;re spending time on minor, unnecessary context&nbsp;switches.</p>
<p>I&#8217;m a student currently at my second software internship. As someone who&#8217;s been developing stuff for just a little under two years, I&#8217;m not the fastest, but I&#8217;ve still managed to accumulate a list of small, medium, and large techniques that speed up my development. I feel like adopting <em>every</em> technique possible (like learning how to use the Dvorak keyboard, for me) would be impractical, so these are the ones that keep me fast but sane. It also goes without saying that different tricks will work for different people, so I hope my tips are general enough for most budding&nbsp;developers.</p>
<p>(<em>By the way, most of these work best if you work in a Unix environment. Most of my work these days is done on <span class="caps">OS</span> X and when I&#8217;m ssh&#8217;d into Linux boxes.</em>)
<br>
<br></p>
<h2>Small&nbsp;things</h2>
<p><strong>Select all/copy/paste</strong>&nbsp;(well-known)</p>
<p><code>[Cmd-a]</code>/<code>[Cmd-c]</code>/<code>[Cmd-v]</code></p>
<p><strong>Quickly navigate and select&nbsp;text</strong></p>
<p>Using keyboard shortcuts such as <code>[Cmd-Left/Right]+[Shift-Cmd-Right/Left]</code> to highlight a line. Experiment with&nbsp;these!</p>
<p><strong>Get to the beginning of a line in the&nbsp;shell</strong></p>
<p><code>[Ctrl-a]</code></p>
<p><strong>New tab/Close tab in most programs that have&nbsp;tabs</strong></p>
<p><code>[Cmd-t]</code>/<code>[Cmd-w]</code></p>
<p><strong>Issue the last command in <code>sudo</code> mode</strong></p>
<p><code>sudo !!</code></p>
<p>At first, I thought it was a funny alias my mentor made, as in, &#8220;sudo, darn it!&#8221;. But <code>!!</code> (read: &#8220;<a href="http://ss64.com/bash/bang.html">bang-bang</a>&#8220;) is a great thing to&nbsp;know!!</p>
<p><strong>Launch Sublime Text from the command&nbsp;line</strong></p>
<p>If I&#8217;m not using <a href="http://www.vim.org/download.php">Vim</a> or <a href="http://macdown.uranusjr.com/">MacDown</a>, I open up Sublime like&nbsp;so:</p>
<p><code>subl README.md</code></p>
<p>You can either add an alias to the Sublime app in your shell profile or add a symlink to it in one of the <code>/bin</code> folders of your <code>PATH</code>.</p>
<p><em>More: <a href="http://stackoverflow.com/questions/16199581/opening-sublime-text-on-command-line-as-subl-on-mac-os">Stack Overflow&nbsp;link</a></em></p>
<p><strong>Take advantage of Spotlight (or <a href="https://www.alfredapp.com/">Alfred</a>)</strong></p>
<p>It takes me less than a second to launch the most-used applications on my desktop. To do that, all I have to do is type <code>[Cmd-Space]</code> anywhere and the first few letters, if not just the first letter, of the application.
<br>
<br></p>
<h2>Medium&nbsp;things</h2>
<p><strong>Use&nbsp;oh-my-zsh</strong></p>
<p><a href="https://github.com/robbyrussell/oh-my-zsh">Oh My Zsh</a> is an easy-to-install framework for installing and managing <code>zsh</code>, an alternative shell to <code>bash</code>. The most useful feature for me is its fast autocompletion and ability to simply tab through autocompletion results. It also makes your shell look fancy&nbsp;:)</p>
<p><em>More: <a href="https://www.quora.com/What-is-the-difference-between-bash-and-zsh">Difference between bash and&nbsp;zsh</a></em></p>
<p><strong>Use a good <code>.vimrc</code> if you use&nbsp;Vim</strong></p>
<p>I&#8217;m pretty lazy and use the one by &#8220;amix&#8221; out of the box. If I cared more to study Vimscript, I could roll my own and be an <code>3l33t h4x0r</code>, but this will&nbsp;do.</p>
<p><em>More: <a href="https://github.com/amix/vimrc">The ultimate&nbsp;vimrc</a></em></p>
<p><strong>Add stuff to your <code>.bash_profile</code>/<code>.bashrc</code>/<code>.zshrc</code></strong></p>
<div class="highlight"><pre><span></span><span class="nb">alias</span> <span class="nv">workonproj</span><span class="o">=</span><span class="s2">&quot;ssh -t rainier.ababao@xyz.example.com &#39;cd ~/project_directory; bash&#39;&quot;</span>
</pre></div>


<p>It&#8217;s quite nice to open up the shell and type in a short alias to ssh into a&nbsp;server.</p>
<div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">GITPAT</span><span class="o">=</span><span class="s2">&quot;xyz&quot;</span>
</pre></div>


<p>If I have GitHub two-factor auth enabled, I&#8217;m required to use a &#8220;personal access token&#8221; to authenticate pushes if I cloned by <span class="caps">HTTPS</span> instead of <span class="caps">SSH</span>. In that case, I can just <code>echo $GITPAT</code> since it&#8217;s an environment variable in my private shell profile, and copy-paste it whenever I have to authenticate. However, I stopped doing this when I learned about triggers for my&nbsp;terminal&#8230;</p>
<p><em>More: <a href="http://linuxcommand.org/lc3_learning_the_shell.php">Learning the&nbsp;Shell</a></em></p>
<p><strong>Take advantage of&nbsp;iTerm2</strong></p>
<p>For command line work, I use iTerm2 instead of Terminal. There are a lot of great things about it, and one of them is triggers. A trigger is a regex that iTerm2 listens for, followed by an action, like automatically entering text as if the user had typed it in themselves. I have a trigger set up so that when <code>\[sudo\] password for rainier.ababao</code> appears, the password manager opens and I just press <code>[Enter]</code> for iTerm2 to put in my&nbsp;password.</p>
<p><em>More: <a href="https://www.iterm2.com/documentation-triggers.html">iTerm2 triggers</a></em>
<br>
<br></p>
<h2>Large&nbsp;things</h2>
<p><strong>Improve your words per minute (<span class="caps">WPM</span>)</strong></p>
<p>Learn to keep your fingers on the home row and touch-type! It will be slow at first, but you&#8217;ll see gains from 40 <span class="caps">WPM</span> to 100-120 <span class="caps">WPM</span> within a few months if you practice <em>every day</em>. That&#8217;s at least <em>doubling</em> one&#8217;s typing&nbsp;speed!</p>
<p>(<em>Edit</em>: This isn&#8217;t to suggest that efficient coding has much to do with how fast you can type, but rather that this reduces the repetitive task of looking for unnaturally-placed characters on the&nbsp;keyboard.)</p>
<p><em>Some fun: <a href="http://play.typeracer.com/">play.typeracer.com</a></em></p>
<p><strong>Master a text&nbsp;editor</strong></p>
<p>I started forcing myself to use Vim last year and have since gotten faster editing with it than with any other text editor. Vim comes installed with <code>vimtutor</code>, a classic interactive tutorial for the&nbsp;editor.</p>
<p>The common thread in a lot of these micro-optimizations is keeping your fingers on the keyboard and away from the mouse.
<br>
<br>
<em>What are your favorite optimizations? Feel free to <span class="caps">DM</span> or tweet <a href="https://twitter.com/rainieratx">@rainieratx</a> with corrections and&nbsp;suggestions.</em></p>
  </div>
  <div class="post">
    <h1 class="post-title">
      <a href="/latex-in-a-makefile.html" rel="bookmark" title="Permalink to LaTeX in a Makefile">LaTeX in a&nbsp;Makefile</a>
    </h1>
    <span class="post-date">March 12, 2016</span>

    <p>In my parallel computing class this semester, we have to write reports with timing results and some analysis using LaTeX. Since we already cook up Makefiles to compile our <span class="caps">MPI</span> C programs, why don&#8217;t we construct our reports the same way&nbsp;too?</p>
<p>Here is a Makefile I wrote to compile my programs and construct the <span class="caps">PDF</span> for my&nbsp;report:</p>
<div class="highlight"><pre><span></span><span class="nv">LATEXTMP</span><span class="o">=</span>*.aux *.log *.toc
<span class="nv">EXECS</span><span class="o">=</span>ex6 ex7
<span class="nv">MPICC</span><span class="o">?=</span>mpicc
<span class="nv">LATEXCMP</span><span class="o">=</span>pdflatex

<span class="nf">all</span><span class="o">:</span> ${<span class="n">EXECS</span>}

<span class="nf">ex6</span><span class="o">:</span> <span class="n">ex</span>6.<span class="n">c</span>
    <span class="si">${</span><span class="nv">MPICC</span><span class="si">}</span> -o ex6 ex6.c

<span class="nf">ex7</span><span class="o">:</span> <span class="n">ex</span>7.<span class="n">c</span>
    <span class="si">${</span><span class="nv">MPICC</span><span class="si">}</span> -o ex7 ex7.c

<span class="nf">report</span><span class="o">:</span> <span class="n">report</span>.<span class="n">tex</span>
    <span class="si">${</span><span class="nv">LATEXCMP</span><span class="si">}</span> report.tex

<span class="nf">clean</span><span class="o">:</span>
    rm <span class="si">${</span><span class="nv">EXECS</span><span class="si">}</span> <span class="si">${</span><span class="nv">LATEXTMP</span><span class="si">}</span>
</pre></div>


<p>If you are familiar with Make, this set of rules should be fairly straightforward to follow. I also find this useful for getting rid of the temporary files that pdflatex generates, without say, fat-fingering a regex upon <code>rm</code>.</p>
<p>If this is new to you, the <a href="https://www.gnu.org/software/make/manual/make.html#Introduction"><span class="caps">GNU</span> Make Manual</a> is a well-written tutorial to&nbsp;start.</p>
<p>Make Make great again!&nbsp;😛</p>
<p><em>What kind of automation tools do you use for tasks that aren&#8217;t typically&nbsp;automated?</em></p>
  </div>
  <div class="post">
    <h1 class="post-title">
      <a href="/binary-search-implementation-in-erlang-whats-going-on.html" rel="bookmark" title="Permalink to Binary search implementation in Erlang - what’s going on?">Binary search implementation in Erlang - what&#8217;s going&nbsp;on?</a>
    </h1>
    <span class="post-date">December 27, 2015</span>

    <h2>Let&#8217;s hack on some&nbsp;Erlang</h2>
<p>Erlang was originally built in the late 80s to handle telecom switches. As such, its major features include primitives for concurrency and error recovery, which led to it making its way into applications requiring fault-tolerance, scalability, and maximum availability. I picked it up to learn more about concurrent programming and because it seemed&nbsp;hip.</p>
<p>Plus, here&#8217;s an awkwardly-funny video about one of its original uses in&nbsp;telephony:</p>
<iframe width="420" height="315" src="https://www.youtube.com/embed/xrIjfIjssLE" frameborder="0" allowfullscreen></iframe>

<h2>Setup</h2>
<p>If you&#8217;re on <span class="caps">OSX</span> and have <a href="http://brew.sh/" target="_blank">Homebrew</a>, you can install Erlang with <code>brew install Erlang</code>.</p>
<p>Now <code>cd</code> into a directory where you want to keep your file. To make things simpler, you&#8217;ll want to save your program and run the Erlang <span class="caps">REPL</span> from here, too. <code>vim binary_search.erl</code>, and let&#8217;s&nbsp;begin!</p>
<h2>Writing the&nbsp;header</h2>
<div class="highlight"><pre><span></span><span class="p">-</span><span class="ni">module</span><span class="p">(</span><span class="n">binary_search</span><span class="p">).</span>
<span class="p">-</span><span class="ni">export</span><span class="p">([</span><span class="n">binary_search</span><span class="o">/</span><span class="mi">2</span><span class="p">]).</span>
</pre></div>


<p><strong>What&#8217;s going&nbsp;on?</strong></p>
<ul>
<li>A <em>module</em> is just a bunch of functions regrouped into a single file, and has to be the first statement of the&nbsp;file.</li>
<li>We can use the name <code>binary_search</code> to call functions from <em>this</em> module into in other modules, in the form <code>M:F(A)</code>, where <code>M</code> is the module name, <code>F</code> is the function name, and <code>A</code> is the&nbsp;arguments.</li>
<li><code>-export([binary_search/2])</code> defines which functions of the module can be called by the outside world, it describes the public interface of the module. It&#8217;s similar to how encapsulation in <span class="caps">OOP</span> restricts an object&#8217;s externally-usable components through the notions of <code>public</code> and <code>private</code> methods.</li>
<li>The <code>export</code> attribute has the format <code>-export([Function1/Arity, Function2/Arity, ..., FunctionN/Arity])</code>. The <em>arity</em> of a function or operator is the number of arguments or operands it takes. Thusly, <code>binary_search</code> has an arity of&nbsp;2.</li>
</ul>
<h2>Guarding against incorrect&nbsp;types</h2>
<p>The parameters of a binary search should be some comparable target value and a sorted&nbsp;list.</p>
<div class="highlight"><pre><span></span><span class="nf">binary_search</span><span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="nv">List</span><span class="p">)</span>
    <span class="k">when</span>
        <span class="nb">is_number</span><span class="p">(</span><span class="nv">X</span><span class="p">),</span>
        <span class="nb">is_list</span><span class="p">(</span><span class="nv">List</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="n">bs</span><span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="nn">lists</span><span class="p">:</span><span class="nf">sort</span><span class="p">(</span><span class="nv">List</span><span class="p">)).</span>
</pre></div>


<p><strong>What&#8217;s going&nbsp;on?</strong></p>
<ul>
<li><code>is_number</code> and <code>is_list</code> are built-in functions of Erlang, and they do exactly what you&#8217;d expect. They are part of the <code>erlang</code> module, which is automatically imported whenever you use&nbsp;Erlang.</li>
<li>But every other function will have to be called in the <code>M:F(A)</code> format described in the last section (<code>M</code> - module name, <code>F</code> - function name, <code>A</code> - arguments)<ul>
<li>In fact, this is how you will call every function you use in Erlang besides those in the <code>erlang</code> module.</li>
<li>You know how in Python, you can just <code>from time import sleep</code>, or in C, you <code>#include &lt;stdio.h&gt;</code> to add function names into the current namespace? Well, Erlang has a very flat namespace. This <a href="http://stackoverflow.com/a/4476599/5150563" target="_blank">Stack Overflow link</a> has a good explanation of how it&nbsp;works.</li>
</ul>
</li>
<li><code>when</code> is called a &#8220;guard&#8221; type of clause, and it tells us to perform the action following the <code>-&gt;</code> if all statements between <code>when</code> and <code>it</code> are&nbsp;true.</li>
<li>Every function ends with a period. Whatever is the last expression of a function to be executed will have its value returned to the caller without it being&nbsp;mentioned.</li>
</ul>
<h2>The&nbsp;algorithm</h2>
<p>The classic binary search algorithm. We will implement it&nbsp;recursively.  </p>
<p>So, here&#8217;s how it looks in&nbsp;Erlang:</p>
<div class="highlight"><pre><span></span><span class="nf">bs</span><span class="p">(_,</span> <span class="p">[])</span>   <span class="o">-&gt;</span> <span class="n">false</span><span class="p">;</span>
<span class="nf">bs</span><span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="p">[_])</span>  <span class="o">-&gt;</span> <span class="n">false</span><span class="p">;</span>
<span class="nf">bs</span><span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="p">[</span><span class="nv">X</span><span class="p">])</span>  <span class="o">-&gt;</span> <span class="n">true</span><span class="p">;</span>
<span class="nf">bs</span><span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="nv">List</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="n">ok</span> <span class="o">=</span> <span class="nn">io</span><span class="p">:</span><span class="nf">format</span><span class="p">(</span><span class="s">&quot;bs(</span><span class="si">~p</span><span class="s">, </span><span class="si">~p</span><span class="s">)</span><span class="si">~n</span><span class="s">&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nv">X</span><span class="p">,</span> <span class="nv">List</span><span class="p">]),</span>
    <span class="nv">Length</span> <span class="o">=</span> <span class="nb">length</span><span class="p">(</span><span class="nv">List</span><span class="p">),</span>
    <span class="nv">Middle</span> <span class="o">=</span> <span class="p">(</span><span class="nv">Length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">div</span> <span class="mi">2</span><span class="p">,</span>
    <span class="nv">Value</span> <span class="o">=</span> <span class="nn">lists</span><span class="p">:</span><span class="nf">nth</span><span class="p">(</span><span class="nv">Middle</span><span class="p">,</span> <span class="nv">List</span><span class="p">),</span>
    <span class="k">if</span>
        <span class="nv">X</span> <span class="o">==</span> <span class="nv">Value</span> <span class="o">-&gt;</span> <span class="n">true</span><span class="p">;</span>
        <span class="nv">X</span> <span class="o">&gt;</span> <span class="nv">Value</span> <span class="o">-&gt;</span> <span class="n">bs</span><span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="nn">lists</span><span class="p">:</span><span class="nf">sublist</span><span class="p">(</span><span class="nv">List</span><span class="p">,</span> <span class="nv">Middle</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nv">Length</span><span class="p">));</span>
        <span class="nv">X</span> <span class="o">&lt;</span> <span class="nv">Value</span> <span class="o">-&gt;</span> <span class="n">bs</span><span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="nn">lists</span><span class="p">:</span><span class="nf">sublist</span><span class="p">(</span><span class="nv">List</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nv">Middle</span><span class="p">))</span>
    <span class="k">end</span><span class="p">.</span>
</pre></div>


<p><strong>What&#8217;s going&nbsp;on?</strong></p>
<ul>
<li>The <code>_</code> is the &#8220;don&#8217;t care&#8221; variable, which is a common thing to use in many languages (for instance, whenever you&#8217;re iterating and not using the counter, e.g. <code>for _ in range(0, 10)</code>). This also happens to silence a &#8220;unused variable&#8221; warning made by the Erlang compiler.<ul>
<li>We see these in use for two of the base cases, and their placement makes sense if you think about it. Binary search of an empty list, list containing useless information, or target variable containing useless information should never be&nbsp;true.</li>
</ul>
</li>
<li>We see use of <em>pattern-matching</em>. Instead&nbsp;of</li>
</ul>
<div class="highlight"><pre><span></span><span class="nf">function</span><span class="p">(</span><span class="nv">Args</span><span class="p">)</span>
   <span class="k">if</span> <span class="nv">X</span> <span class="n">then</span>
      <span class="nv">Expression</span>
   <span class="n">else</span> <span class="k">if</span> <span class="nv">Y</span> <span class="n">then</span>
      <span class="nv">Expression</span>
   <span class="n">else</span>
      <span class="nv">Expression</span>
</pre></div>


<p>We&nbsp;write:</p>
<div class="highlight"><pre><span></span><span class="nf">function</span><span class="p">(</span><span class="nv">X</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="nv">Expression</span><span class="p">;</span>
<span class="nf">function</span><span class="p">(</span><span class="nv">Y</span><span class="p">)</span> <span class="o">-&gt;</span>
  <span class="nv">Expression</span><span class="p">;</span>
<span class="nf">function</span><span class="p">(_)</span> <span class="o">-&gt;</span>
  <span class="nv">Expression</span><span class="p">.</span>
</pre></div>


<h2>The final&nbsp;code</h2>
<p>Your file, <code>binary_search.erl</code>, should look something like this at the&nbsp;end:</p>
<div class="highlight"><pre><span></span><span class="p">-</span><span class="ni">module</span><span class="p">(</span><span class="n">binary_search</span><span class="p">).</span>
<span class="p">-</span><span class="ni">export</span><span class="p">([</span><span class="n">binary_search</span><span class="o">/</span><span class="mi">2</span><span class="p">]).</span>

<span class="nf">binary_search</span><span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="nv">List</span><span class="p">)</span>
    <span class="k">when</span>
        <span class="nb">is_number</span><span class="p">(</span><span class="nv">X</span><span class="p">),</span>
        <span class="nb">is_list</span><span class="p">(</span><span class="nv">List</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="n">bs</span><span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="nn">lists</span><span class="p">:</span><span class="nf">sort</span><span class="p">(</span><span class="nv">List</span><span class="p">)).</span>

<span class="nf">bs</span><span class="p">(_,</span> <span class="p">[])</span>   <span class="o">-&gt;</span> <span class="n">false</span><span class="p">;</span>
<span class="nf">bs</span><span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="p">[</span><span class="nv">X</span><span class="p">])</span>  <span class="o">-&gt;</span> <span class="n">true</span><span class="p">;</span>
<span class="nf">bs</span><span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="p">[_])</span>  <span class="o">-&gt;</span> <span class="n">false</span><span class="p">;</span>
<span class="nf">bs</span><span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="nv">List</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="n">ok</span> <span class="o">=</span> <span class="nn">io</span><span class="p">:</span><span class="nf">format</span><span class="p">(</span><span class="s">&quot;bs(</span><span class="si">~p</span><span class="s">, </span><span class="si">~p</span><span class="s">)</span><span class="si">~n</span><span class="s">&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nv">X</span><span class="p">,</span> <span class="nv">List</span><span class="p">]),</span>
    <span class="nv">Length</span> <span class="o">=</span> <span class="nb">length</span><span class="p">(</span><span class="nv">List</span><span class="p">),</span>
    <span class="nv">Middle</span> <span class="o">=</span> <span class="p">(</span><span class="nv">Length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">div</span> <span class="mi">2</span><span class="p">,</span>
    <span class="nv">Value</span> <span class="o">=</span> <span class="nn">lists</span><span class="p">:</span><span class="nf">nth</span><span class="p">(</span><span class="nv">Middle</span><span class="p">,</span> <span class="nv">List</span><span class="p">),</span>
    <span class="k">if</span>
        <span class="nv">X</span> <span class="o">==</span> <span class="nv">Value</span> <span class="o">-&gt;</span> <span class="n">true</span><span class="p">;</span>
        <span class="nv">X</span> <span class="o">&gt;</span> <span class="nv">Value</span> <span class="o">-&gt;</span> <span class="n">bs</span><span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="nn">lists</span><span class="p">:</span><span class="nf">sublist</span><span class="p">(</span><span class="nv">List</span><span class="p">,</span> <span class="nv">Middle</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nv">Length</span><span class="p">));</span>
        <span class="nv">X</span> <span class="o">&lt;</span> <span class="nv">Value</span> <span class="o">-&gt;</span> <span class="n">bs</span><span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="nn">lists</span><span class="p">:</span><span class="nf">sublist</span><span class="p">(</span><span class="nv">List</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nv">Middle</span><span class="p">))</span>
    <span class="k">end</span><span class="p">.</span>
</pre></div>


<h2>Putting it to&nbsp;use</h2>
<div class="highlight"><pre><span></span><span class="sc">$ </span><span class="n">erl</span>
<span class="nv">Erlang</span><span class="o">/</span><span class="nv">OTP</span> <span class="mi">18</span> <span class="p">[</span><span class="n">erts</span><span class="o">-</span><span class="mi">7</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span><span class="p">]</span> <span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="p">[</span><span class="mi">64</span><span class="o">-</span><span class="n">bit</span><span class="p">]</span> <span class="p">[</span><span class="nn">smp</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span> <span class="p">[</span><span class="n">async</span><span class="o">-</span><span class="nn">threads</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="p">[</span><span class="n">hipe</span><span class="p">]</span> <span class="p">[</span><span class="n">kernel</span><span class="o">-</span><span class="nn">poll</span><span class="p">:</span><span class="n">false</span><span class="p">]</span> <span class="p">[</span><span class="n">dtrace</span><span class="p">]</span>

<span class="nv">Eshell</span> <span class="nv">V7</span><span class="p">.</span><span class="mi">2</span><span class="p">.</span><span class="mi">1</span>  <span class="p">(</span><span class="n">abort</span> <span class="n">with</span> <span class="err">^</span><span class="nv">G</span><span class="p">)</span>
<span class="mi">1</span><span class="o">&gt;</span> <span class="n">c</span><span class="p">(</span><span class="n">binary_search</span><span class="p">).</span>
<span class="p">{</span><span class="n">ok</span><span class="p">,</span><span class="n">binary_search</span><span class="p">}</span>
<span class="mi">2</span><span class="o">&gt;</span> <span class="nn">binary_search</span><span class="p">:</span><span class="nf">binary_search</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]).</span>
<span class="nf">bs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="nf">bs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">true</span>
</pre></div>


<p>Cool! I know I left out a lot of stuff - mostly because I don&#8217;t want to rewrite all of <em><a href="http://learnyousomeerlang.com/">Learn You Some Erlang for Great&nbsp;Good!</a></em></p>
<p>And I really hope this piques your interest to learn it more formally. If you want to learn more about Erlang, I <em>highly</em> recommend reading some of the links&nbsp;below.</p>
<h2>Sources</h2>
<p>[1] <a href="http://www.erlang.org/course/history.html">http://www.erlang.org/course/history.html</a><br />
[2] <a href="http://www.erlang.org/course/history.html">http://veldstra.org/whyerlang/</a><br />
[3] <a href="http://learnyousomeerlang.com/">http://learnyousomeerlang.com/</a>  </p>
  </div>
</div>
      </div>

      <label for="sidebar-checkbox" class="sidebar-toggle"></label>

      <script>
        (function(document) {
          var i = 0;
          // snip empty header rows since markdown can't
          var rows = document.querySelectorAll('tr');
          for(i=0; i<rows.length; i++) {
            var ths = rows[i].querySelectorAll('th');
            var rowlen = rows[i].children.length;
            if (ths.length > 0 && ths.length === rowlen) {
              rows[i].remove();
            }
          }
        })(document);
      </script>

      <script>
        /* Lanyon & Poole are Copyright (c) 2014 Mark Otto. Adapted to Pelican 20141223 and extended a bit by @thomaswilley */
        (function(document) {
          var toggle = document.querySelector('.sidebar-toggle');
          var sidebar = document.querySelector('#sidebar');
          var checkbox = document.querySelector('#sidebar-checkbox');
          document.addEventListener('click', function(e) {
            var target = e.target;
            if(!checkbox.checked ||
            sidebar.contains(target) ||
            (target === checkbox || target === toggle)) return;
            checkbox.checked = false;
            }, false);
            })(document);
      </script>
      <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-57948440-1']);
        _gaq.push(['_trackPageview']);
        (function() {
         var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
         ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
         var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
         })();
       </script>
     </div>
  </body>
</html>